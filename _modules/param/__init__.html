
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>param.__init__ â€” param 1.11.1 documentation</title>
<link href="../../_static/css/theme.css" rel="stylesheet"/>
<link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet"/>
<link href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../_static/basic.css" rel="stylesheet" type="text/css">
<link href="../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../_static/mystnb.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/graphviz.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/site.css" rel="stylesheet" type="text/css"/>
<link as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js" rel="preload"/>
<script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
<script src="../../_static/jquery.js"></script>
<script src="../../_static/underscore.js"></script>
<script src="../../_static/doctools.js"></script>
<script src="../../_static/togglebutton.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<link href="../../about.html" rel="author" title="About these documents">
<link href="../../genindex.html" rel="index" title="Index"/>
<link href="../../search.html" rel="search" title="Search"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
</link></link></link></link></head>
<body data-offset="80" data-spy="scroll" data-target="#bd-toc-nav">
<div class="container-fluid" id="banner"></div>
<nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">
<div id="navbar-start">
<a class="navbar-brand" href="../../index.html">
<img alt="logo" class="logo" src="../../_static/logo_horizontal.png"/>
</a>
</div>
<button aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#navbar-collapsible" data-toggle="collapse" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="col-lg-9 collapse navbar-collapse" id="navbar-collapsible">
<div class="mr-auto" id="navbar-center">
<div class="navbar-center-item">
<ul class="navbar-nav" id="navbar-main-elements">
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../../index.html">
  Introduction
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../../getting_started.html">
  Getting Started
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../../user_guide/index.html">
  User Guide
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../../comparisons.html">
  Comparisons
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../../roadmap.html">
  Roadmap
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../../reference.html">
  API
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference external nav-link" href="https://github.com/holoviz/param">
  Github Source
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../../about.html">
  About
 </a>
</li>
</ul>
</div>
</div>
<div id="navbar-end">
<div class="navbar-end-item">
<ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
<li class="nav-item">
<a class="nav-link" href="https://github.com/holoviz/param" rel="noopener" target="_blank" title="GitHub">
<span><i class="fab fa-github-square"></i></span>
<label class="sr-only">GitHub</label>
</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://discourse.holoviz.org/" rel="noopener" target="_blank" title="Discourse">
<span><i class="fab fa-discourse"></i></span>
<label class="sr-only">Discourse</label>
</a>
</li>
</ul>
</div>
</div>
</div>
</div>
</nav>
<div class="container-xl">
<div class="row">
<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="col-12 col-md-3 bd-sidebar"><form action="../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search the docs ..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search the docs ..." type="search"/>
</form><nav aria-label="Main navigation" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
</div>
</nav>
</div>
<div class="d-none d-xl-block col-xl-2 bd-toc">
</div>
<main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
<div>
<h1>Source code for param.__init__</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="sd">"""</span>
<span class="sd">Parameters are a kind of class attribute allowing special behavior,</span>
<span class="sd">including dynamically generated parameter values, documentation</span>
<span class="sd">strings, constant and read-only parameters, and type or range checking</span>
<span class="sd">at assignment time.</span>

<span class="sd">Potentially useful for any large Python program that needs</span>
<span class="sd">user-modifiable object attributes; see the Parameter and Parameterized</span>
<span class="sd">classes for more information.  If you do not want to add a dependency</span>
<span class="sd">on external code by importing from a separately installed param</span>
<span class="sd">package, you can simply save this file as param.py and copy it and</span>
<span class="sd">parameterized.py directly into your own package.</span>

<span class="sd">This file contains subclasses of Parameter, implementing specific</span>
<span class="sd">parameter types (e.g. Number), and also imports the definition of</span>
<span class="sd">Parameters and Parameterized classes.</span>
<span class="sd">"""</span>

<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">collections</span>

<span class="kn">from</span> <span class="nn">.parameterized</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Parameterized</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">String</span><span class="p">,</span> <span class="n">ParameterizedFunction</span><span class="p">,</span> <span class="n">ParamOverrides</span><span class="p">,</span>
    <span class="n">descendents</span><span class="p">,</span> <span class="n">get_logger</span><span class="p">,</span> <span class="n">instance_descriptor</span><span class="p">,</span> <span class="n">basestring</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">.parameterized</span> <span class="kn">import</span> <span class="p">(</span><span class="n">batch_watch</span><span class="p">,</span> <span class="n">depends</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="c1"># noqa: api import</span>
                            <span class="n">discard_events</span><span class="p">,</span> <span class="n">edit_constant</span><span class="p">,</span> <span class="n">instance_descriptor</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.parameterized</span> <span class="kn">import</span> <span class="n">logging_level</span>     <span class="c1"># noqa: api import</span>
<span class="kn">from</span> <span class="nn">.parameterized</span> <span class="kn">import</span> <span class="n">shared_parameters</span> <span class="c1"># noqa: api import</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">numbers</span> <span class="kn">import</span> <span class="n">Real</span>

<span class="c1"># Determine up-to-date version information, if possible, but with a</span>
<span class="c1"># safe fallback to ensure that this file and parameterized.py are the</span>
<span class="c1"># only two required files.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">.version</span> <span class="kn">import</span> <span class="n">Version</span>
    <span class="n">__version__</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Version</span><span class="p">(</span><span class="n">fpath</span><span class="o">=</span><span class="vm">__file__</span><span class="p">,</span> <span class="n">archive_commit</span><span class="o">=</span><span class="s2">"$Format:%h$"</span><span class="p">,</span> <span class="n">reponame</span><span class="o">=</span><span class="s2">"param"</span><span class="p">))</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">__version__</span> <span class="o">=</span> <span class="s2">"0.0.0+unknown"</span>


<span class="n">dt_types</span> <span class="o">=</span> <span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">dt_types</span> <span class="o">=</span> <span class="n">dt_types</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">,)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>


<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">collections.abc</span> <span class="k">as</span> <span class="nn">collections_abc</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">collections_abc</span> <span class="o">=</span> <span class="n">collections</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
    <span class="n">unicode</span> <span class="o">=</span> <span class="nb">str</span>

<span class="c1">#: Top-level object to allow messaging not tied to a particular</span>
<span class="c1">#: Parameterized object, as in 'param.main.warning("Invalid option")'.</span>
<span class="n">main</span><span class="o">=</span><span class="n">Parameterized</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"main"</span><span class="p">)</span>


<span class="c1"># A global random seed (integer or rational) available for controlling</span>
<span class="c1"># the behaviour of parameterized objects with random state.</span>
<span class="n">random_seed</span> <span class="o">=</span> <span class="mi">42</span>


<div class="viewcode-block" id="produce_value"><a class="viewcode-back" href="../../reference.html#param.__init__.produce_value">[docs]</a><span class="k">def</span> <span class="nf">produce_value</span><span class="p">(</span><span class="n">value_obj</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    A helper function that produces an actual parameter from a stored</span>
<span class="sd">    object: if the object is callable, call it, otherwise return the</span>
<span class="sd">    object.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">value_obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value_obj</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">value_obj</span></div>


<div class="viewcode-block" id="as_unicode"><a class="viewcode-back" href="../../reference.html#param.__init__.as_unicode">[docs]</a><span class="k">def</span> <span class="nf">as_unicode</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Safely casts any object to unicode including regular string</span>
<span class="sd">    (i.e. bytes) types in python 2.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">major</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">unicode</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div>


<div class="viewcode-block" id="is_ordered_dict"><a class="viewcode-back" href="../../reference.html#param.__init__.is_ordered_dict">[docs]</a><span class="k">def</span> <span class="nf">is_ordered_dict</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Predicate checking for ordered dictionaries. OrderedDict is always</span>
<span class="sd">    ordered, and vanilla Python dictionaries are ordered for Python 3.6+</span>
<span class="sd">    """</span>
    <span class="n">py3_ordered_dicts</span> <span class="o">=</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">major</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">minor</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">vanilla_odicts</span> <span class="o">=</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">major</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">or</span> <span class="n">py3_ordered_dicts</span>
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">(</span><span class="n">OrderedDict</span><span class="p">))</span><span class="ow">or</span> <span class="p">(</span><span class="n">vanilla_odicts</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">))</span></div>


<div class="viewcode-block" id="hashable"><a class="viewcode-back" href="../../reference.html#param.__init__.hashable">[docs]</a><span class="k">def</span> <span class="nf">hashable</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Return a hashable version of the given object x, with lists and</span>
<span class="sd">    dictionaries converted to tuples.  Allows mutable objects to be</span>
<span class="sd">    used as a lookup key in cases where the object has not actually</span>
<span class="sd">    been mutated. Lookup will fail (appropriately) in cases where some</span>
<span class="sd">    part of the object has changed.  Does not (currently) recursively</span>
<span class="sd">    replace mutable subobjects.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">collections_abc</span><span class="o">.</span><span class="n">MutableSequence</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">collections_abc</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span></div>

<div class="viewcode-block" id="named_objs"><a class="viewcode-back" href="../../reference.html#param.__init__.named_objs">[docs]</a><span class="k">def</span> <span class="nf">named_objs</span><span class="p">(</span><span class="n">objlist</span><span class="p">,</span> <span class="n">namesdict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Given a list of objects, returns a dictionary mapping from</span>
<span class="sd">    string name for the object to the object itself. Accepts</span>
<span class="sd">    an optional name,obj dictionary, which will override any other</span>
<span class="sd">    name if that item is present in the dictionary.</span>
<span class="sd">    """</span>
    <span class="n">objs</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">namesdict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">objtoname</span> <span class="o">=</span> <span class="p">{</span><span class="n">hashable</span><span class="p">(</span><span class="n">v</span><span class="p">):</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">namesdict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objlist</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">namesdict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">hashable</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">in</span> <span class="n">objtoname</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">objtoname</span><span class="p">[</span><span class="n">hashable</span><span class="p">(</span><span class="n">obj</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">"name"</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">'__name__'</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">as_unicode</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">objs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
    <span class="k">return</span> <span class="n">objs</span></div>


<div class="viewcode-block" id="param_union"><a class="viewcode-back" href="../../reference.html#param.__init__.param_union">[docs]</a><span class="k">def</span> <span class="nf">param_union</span><span class="p">(</span><span class="o">*</span><span class="n">parameterizeds</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Given a set of Parameterized objects, returns a dictionary</span>
<span class="sd">    with the union of all param name,value pairs across them.</span>
<span class="sd">    If warn is True (default), warns if the same parameter has</span>
<span class="sd">    been given multiple values; otherwise uses the last value</span>
<span class="sd">    """</span>
    <span class="n">warn</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">'warn'</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">"param_union() got an unexpected keyword argument '</span><span class="si">{}</span><span class="s2">'"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">popitem</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">parameterizeds</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">o</span><span class="o">.</span><span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s1">'name'</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">d</span> <span class="ow">and</span> <span class="n">warn</span><span class="p">:</span>
                    <span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">"overwriting parameter </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
                <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">d</span></div>


<div class="viewcode-block" id="guess_param_types"><a class="viewcode-back" href="../../reference.html#param.__init__.guess_param_types">[docs]</a><span class="k">def</span> <span class="nf">guess_param_types</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Given a set of keyword literals, promote to the appropriate</span>
<span class="sd">    parameter type based on some simple heuristics.</span>
<span class="sd">    """</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">):</span>
            <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">dt_types</span><span class="p">):</span>
            <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Date</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Boolean</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Number</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">_is_number</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">v</span><span class="p">):</span>
                <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">NumericTuple</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">el</span><span class="o">.</span> <span class="n">dt_types</span><span class="p">)</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">v</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">DateRange</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tuple</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">List</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span> <span class="k">as</span> <span class="n">pdDFrame</span>
            <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">Series</span> <span class="k">as</span> <span class="n">pdSeries</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">pdDFrame</span><span class="p">):</span>
                <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">pdSeries</span><span class="p">):</span>
                <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">params</span></div>


<div class="viewcode-block" id="parameterized_class"><a class="viewcode-back" href="../../reference.html#param.__init__.parameterized_class">[docs]</a><span class="k">def</span> <span class="nf">parameterized_class</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">bases</span><span class="o">=</span><span class="n">Parameterized</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Dynamically create a parameterized class with the given name and the</span>
<span class="sd">    supplied parameters, inheriting from the specified base(s).</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">bases</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bases</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">bases</span><span class="o">=</span><span class="p">[</span><span class="n">bases</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">bases</span><span class="p">),</span> <span class="n">params</span><span class="p">)</span></div>


<div class="viewcode-block" id="guess_bounds"><a class="viewcode-back" href="../../reference.html#param.__init__.guess_bounds">[docs]</a><span class="k">def</span> <span class="nf">guess_bounds</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="n">overrides</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Given a dictionary of Parameter instances, return a corresponding</span>
<span class="sd">    set of copies with the bounds appropriately set.</span>


<span class="sd">    If given a set of override keywords, use those numeric tuple bounds.</span>
<span class="sd">    """</span>
    <span class="n">guessed</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">new_param</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">Number</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">overrides</span><span class="p">:</span>
                <span class="n">minv</span><span class="p">,</span><span class="n">maxv</span> <span class="o">=</span> <span class="n">overrides</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">minv</span><span class="p">,</span> <span class="n">maxv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_get_min_max_value</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
            <span class="n">new_param</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="n">minv</span><span class="p">,</span> <span class="n">maxv</span><span class="p">)</span>
        <span class="n">guessed</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_param</span>
    <span class="k">return</span> <span class="n">guessed</span></div>


<span class="k">def</span> <span class="nf">_get_min_max_value</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""Return min, max, value given input values with possible None."""</span>
    <span class="c1"># Either min and max need to be given, or value needs to be given</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">min</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'unable to infer range, value '</span>
                             <span class="s1">'from: (</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">, </span><span class="si">{2}</span><span class="s1">)'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="nb">max</span> <span class="o">-</span> <span class="nb">min</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">min</span> <span class="o">+</span> <span class="p">(</span><span class="n">diff</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c1"># Ensure that value has the same type as diff</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">diff</span><span class="p">)):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">min</span> <span class="o">+</span> <span class="p">(</span><span class="n">diff</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># value is not None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Real</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">'expected a real number, got: </span><span class="si">%r</span><span class="s1">'</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>
        <span class="c1"># Infer min/max from value</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># This gives (0, 1) of the correct type</span>
            <span class="n">vrange</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">value</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">vrange</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">value</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vrange</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">value</span><span class="p">,</span> <span class="o">-</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">min</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">min</span> <span class="o">=</span> <span class="n">vrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">max</span> <span class="o">=</span> <span class="n">vrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">step</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># ensure value is on a step</span>
        <span class="n">tick</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">value</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span> <span class="o">/</span> <span class="n">step</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">min</span> <span class="o">+</span> <span class="n">tick</span> <span class="o">*</span> <span class="n">step</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">min</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="nb">max</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'value must be between min and max (min=</span><span class="si">{0}</span><span class="s1">, value=</span><span class="si">{1}</span><span class="s1">, max=</span><span class="si">{2}</span><span class="s1">)'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="nb">max</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">value</span>


<div class="viewcode-block" id="Infinity"><a class="viewcode-back" href="../../reference.html#param.__init__.Infinity">[docs]</a><span class="k">class</span> <span class="nc">Infinity</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    An instance of this class represents an infinite value. Unlike</span>
<span class="sd">    Python's float('inf') value, this object can be safely compared</span>
<span class="sd">    with gmpy numeric types across different gmpy versions.</span>

<span class="sd">    All operators on Infinity() return Infinity(), apart from the</span>
<span class="sd">    comparison and equality operators. Equality works by checking</span>
<span class="sd">    whether the two objects are both instances of this class.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="fm">__eq__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__ne__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">==</span><span class="n">other</span>
    <span class="k">def</span> <span class="fm">__lt__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
    <span class="k">def</span> <span class="fm">__le__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
    <span class="k">def</span> <span class="fm">__gt__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="kc">True</span>
    <span class="k">def</span> <span class="fm">__ge__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="kc">True</span>
    <span class="k">def</span> <span class="fm">__add__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="nf">__ladd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="fm">__sub__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="nf">__iadd_</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="fm">__isub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>       <span class="k">return</span> <span class="s2">"Infinity()"</span>
    <span class="k">def</span> <span class="fm">__str__</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>       <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>



<div class="viewcode-block" id="Time"><a class="viewcode-back" href="../../reference.html#param.__init__.Time">[docs]</a><span class="k">class</span> <span class="nc">Time</span><span class="p">(</span><span class="n">Parameterized</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    A callable object returning a number for the current time.</span>

<span class="sd">    Here 'time' is an abstract concept that can be interpreted in any</span>
<span class="sd">    useful way.  For instance, in a simulation, it would be the</span>
<span class="sd">    current simulation time, while in a turn-taking game it could be</span>
<span class="sd">    the number of moves so far.  The key intended usage is to allow</span>
<span class="sd">    independent Parameterized objects with Dynamic parameters to</span>
<span class="sd">    remain consistent with a global reference.</span>

<span class="sd">    The time datatype (time_type) is configurable, but should</span>
<span class="sd">    typically be an exact numeric type like an integer or a rational,</span>
<span class="sd">    so that small floating-point errors do not accumulate as time is</span>
<span class="sd">    incremented repeatedly.</span>

<span class="sd">    When used as a context manager using the 'with' statement</span>
<span class="sd">    (implemented by the __enter__ and __exit__ special methods), entry</span>
<span class="sd">    into a context pushes the state of the Time object, allowing the</span>
<span class="sd">    effect of changes to the time value to be explored by setting,</span>
<span class="sd">    incrementing or decrementing time as desired. This allows the</span>
<span class="sd">    state of time-dependent objects to be modified temporarily as a</span>
<span class="sd">    function of time, within the context's block. For instance, you</span>
<span class="sd">    could use the context manager to "see into the future" to collect</span>
<span class="sd">    data over multiple times, without affecting the global time state</span>
<span class="sd">    once exiting the context. Of course, you need to be careful not to</span>
<span class="sd">    do anything while in context that would affect the lasting state</span>
<span class="sd">    of your other objects, if you want things to return to their</span>
<span class="sd">    starting state when exiting the context.</span>

<span class="sd">    The starting time value of a new Time object is 0, converted to</span>
<span class="sd">    the chosen time type. Here is an illustration of how time can be</span>
<span class="sd">    manipulated using a Time object:</span>

<span class="sd">    &gt;&gt;&gt; time = Time(until=20, timestep=1)</span>
<span class="sd">    &gt;&gt;&gt; 'The initial time is %s' % time()</span>
<span class="sd">    'The initial time is 0'</span>
<span class="sd">    &gt;&gt;&gt; 'Setting the time to %s' % time(5)</span>
<span class="sd">    'Setting the time to 5'</span>
<span class="sd">    &gt;&gt;&gt; time += 5</span>
<span class="sd">    &gt;&gt;&gt; 'After incrementing by 5, the time is %s' % time()</span>
<span class="sd">    'After incrementing by 5, the time is 10'</span>
<span class="sd">    &gt;&gt;&gt; with time as t:  # Entering a context</span>
<span class="sd">    ...     'Time before iteration: %s' % t()</span>
<span class="sd">    ...     'Iteration: %s' % [val for val in t]</span>
<span class="sd">    ...     'Time after iteration: %s' % t()</span>
<span class="sd">    ...     t += 2</span>
<span class="sd">    ...     'The until parameter may be exceeded outside iteration: %s' % t()</span>
<span class="sd">    'Time before iteration: 10'</span>
<span class="sd">    'Iteration: [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]'</span>
<span class="sd">    'Time after iteration: 20'</span>
<span class="sd">    'The until parameter may be exceeded outside iteration: 22'</span>
<span class="sd">    &gt;&gt;&gt; 'After exiting the context the time is back to %s' % time()</span>
<span class="sd">    'After exiting the context the time is back to 10'</span>
<span class="sd">    """</span>

    <span class="n">_infinitely_iterable</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">forever</span> <span class="o">=</span> <span class="n">Infinity</span><span class="p">()</span>

    <span class="n">label</span><span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s1">'Time'</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">         The label given to the Time object. Can be used to convey</span>
<span class="s2">         more specific notions of time as appropriate. For instance,</span>
<span class="s2">         the label could be 'Simulation Time' or 'Duration'."""</span><span class="p">)</span>


    <span class="n">time_type</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">        Callable that Time will use to convert user-specified time</span>
<span class="s2">        values into the current time; all times will be of the resulting</span>
<span class="s2">        numeric type.</span>

<span class="s2">        By default, time is of integer type, but you can supply any</span>
<span class="s2">        arbitrary-precision type like a fixed-point decimal or a</span>
<span class="s2">        rational, to allow fractional times.  Floating-point times are</span>
<span class="s2">        also allowed, but are not recommended because they will suffer</span>
<span class="s2">        from accumulated rounding errors.  For instance, incrementing</span>
<span class="s2">        a floating-point value 0.0 by 0.05, 20 times, will not reach</span>
<span class="s2">        1.0 exactly.  Instead, it will be slightly higher than 1.0,</span>
<span class="s2">        because 0.05 cannot be represented exactly in a standard</span>
<span class="s2">        floating point numeric type. Fixed-point or rational types</span>
<span class="s2">        should be able to handle such computations exactly, avoiding</span>
<span class="s2">        accumulation issues over long time intervals.</span>

<span class="s2">        Some potentially useful exact number classes:</span>

<span class="s2">         - int: Suitable if all times can be expressed as integers.</span>

<span class="s2">         - Python's decimal.Decimal and fractions.Fraction classes:</span>
<span class="s2">           widely available but slow and also awkward to specify times</span>
<span class="s2">           (e.g. cannot simply type 0.05, but have to use a special</span>
<span class="s2">           constructor or a string).</span>

<span class="s2">         - fixedpoint.FixedPoint: Allows a natural representation of</span>
<span class="s2">           times in decimal notation, but very slow and needs to be</span>
<span class="s2">           installed separately.</span>

<span class="s2">         - gmpy.mpq: Allows a natural representation of times in</span>
<span class="s2">           decimal notation, and very fast because it uses the GNU</span>
<span class="s2">           Multi-Precision library, but needs to be installed</span>
<span class="s2">           separately and depends on a non-Python library.  gmpy.mpq</span>
<span class="s2">           is gmpy's rational type.</span>
<span class="s2">        """</span><span class="p">)</span>

    <span class="n">timestep</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">        Stepsize to be used with the iterator interface.</span>
<span class="s2">        Time can be advanced or decremented by any value, not just</span>
<span class="s2">        those corresponding to the stepsize, and so this value is only</span>
<span class="s2">        a default."""</span><span class="p">)</span>

    <span class="n">until</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">forever</span><span class="p">,</span><span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">         Declaration of an expected end to time values, if any.  When</span>
<span class="s2">         using the iterator interface, iteration will end before this</span>
<span class="s2">         value is exceeded."""</span><span class="p">)</span>

    <span class="n">unit</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">        The units of the time dimensions. The default of None is set</span>
<span class="s2">        as the global time function may on an arbitrary time base.</span>

<span class="s2">        Typical values for the parameter are 'seconds' (the SI unit</span>
<span class="s2">        for time) or subdivisions thereof (e.g. 'milliseconds')."""</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Time</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_type</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_exhausted</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pushed_state</span> <span class="o">=</span> <span class="p">[]</span>


    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Time</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">self_params</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">until</span><span class="p">)</span>
        <span class="n">other_params</span> <span class="o">=</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span><span class="n">other</span><span class="o">.</span><span class="n">until</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">self_params</span> <span class="o">!=</span> <span class="n">other_params</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>


    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span> <span class="o">==</span> <span class="n">other</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">timestep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exhausted</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exhausted</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">+</span> <span class="n">timestep</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">until</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">+=</span> <span class="n">timestep</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exhausted</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>

    <span class="c1"># For Python 2 compatibility; can be removed for Python 3.</span>
    <span class="nb">next</span> <span class="o">=</span> <span class="fm">__next__</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        When called with no arguments, returns the current time value.</span>

<span class="sd">        When called with a specified val, sets the time to it.</span>

<span class="sd">        When called with a specified time_type, changes the time_type</span>
<span class="sd">        and sets the current time to the given val (which *must* be</span>
<span class="sd">        specified) converted to that time type.  To ensure that</span>
<span class="sd">        the current state remains consistent, this is normally the only</span>
<span class="sd">        way to change the time_type of an existing Time instance.</span>
<span class="sd">        """</span>

        <span class="k">if</span> <span class="n">time_type</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">"Please specify a value for the new time_type."</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">time_type</span><span class="p">:</span>
            <span class="n">type_param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">objects</span><span class="p">(</span><span class="s1">'existing'</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'time_type'</span><span class="p">)</span>
            <span class="n">type_param</span><span class="o">.</span><span class="n">constant</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_type</span> <span class="o">=</span> <span class="n">time_type</span>
            <span class="n">type_param</span><span class="o">.</span><span class="n">constant</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>


    <span class="k">def</span> <span class="nf">advance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span> <span class="o">+=</span> <span class="n">val</span>


    <span class="k">def</span> <span class="fm">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="fm">__isub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""Enter the context and push the current state."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pushed_state</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">until</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_context</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Exit from the current context, restoring the previous state.</span>
<span class="sd">        The StopIteration exception raised in context will force the</span>
<span class="sd">        context to exit. Any other exception exc that is raised in the</span>
<span class="sd">        block will not be caught.</span>
<span class="sd">        """</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">until</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pushed_state</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_context</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pushed_state</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">exc</span> <span class="ow">is</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span></div>



<div class="viewcode-block" id="Dynamic"><a class="viewcode-back" href="../../reference.html#param.__init__.Dynamic">[docs]</a><span class="k">class</span> <span class="nc">Dynamic</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value can be generated dynamically by a callable</span>
<span class="sd">    object.</span>

<span class="sd">    If a Parameter is declared as Dynamic, it can be set a callable</span>
<span class="sd">    object (such as a function or callable class), and getting the</span>
<span class="sd">    parameter's value will call that callable.</span>

<span class="sd">    Note that at present, the callable object must allow attributes</span>
<span class="sd">    to be set on itself.</span>

<span class="sd">    [Python 2.4 limitation: the callable object must be an instance of a</span>
<span class="sd">    callable class, rather than a named function or a lambda function,</span>
<span class="sd">    otherwise the object will not be picklable or deepcopyable.]</span>

<span class="sd">    If set as time_dependent, setting the Dynamic.time_fn allows the</span>
<span class="sd">    production of dynamic values to be controlled: a new value will be</span>
<span class="sd">    produced only if the current value of time_fn is different from</span>
<span class="sd">    what it was the last time the parameter value was requested.</span>

<span class="sd">    By default, the Dynamic parameters are not time_dependent so that</span>
<span class="sd">    new values are generated on every call regardless of the time. The</span>
<span class="sd">    default time_fn used when time_dependent is a single Time instance</span>
<span class="sd">    that allows general manipulations of time. It may be set to some</span>
<span class="sd">    other callable as required so long as a number is returned on each</span>
<span class="sd">    call.</span>
<span class="sd">    """</span>

    <span class="n">time_fn</span> <span class="o">=</span> <span class="n">Time</span><span class="p">()</span>
    <span class="n">time_dependent</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># CBENHANCEMENT: Add an 'epsilon' slot.</span>
    <span class="c1"># See email 'Re: simulation-time-controlled Dynamic parameters'</span>
    <span class="c1"># Dec 22, 2007 CB-&gt;JAB</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Call the superclass's __init__ and set instantiate=True if the</span>
<span class="sd">        default is dynamic.</span>
<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Dynamic</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_instantiate</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_generator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_initialize_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">gen</span><span class="p">,</span><span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Add 'last time' and 'last value' attributes to the generator.</span>
<span class="sd">        """</span>
        <span class="c1"># CEBALERT: use a dictionary to hold these things.</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="s2">"_Dynamic_time_fn"</span><span class="p">):</span>
            <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_time_fn</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">_Dynamic_time_fn</span>

        <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_last</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># CEB: I'd use None for this, except can't compare a fixedpoint</span>
        <span class="c1"># number with None (e.g. 1&gt;None but FixedPoint(1)&gt;None can't be done)</span>
        <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_time</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">gen</span><span class="o">.</span><span class="n">_saved_Dynamic_last</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">gen</span><span class="o">.</span><span class="n">_saved_Dynamic_time</span> <span class="o">=</span> <span class="p">[]</span>


    <span class="k">def</span> <span class="fm">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Call the superclass's __get__; if the result is not dynamic</span>
<span class="sd">        return that result, otherwise ask that result to produce a</span>
<span class="sd">        value and return it.</span>
<span class="sd">        """</span>
        <span class="n">gen</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Dynamic</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span><span class="s1">'_Dynamic_last'</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">gen</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_produce_value</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>


    <span class="nd">@instance_descriptor</span>
    <span class="k">def</span> <span class="fm">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Call the superclass's set and keep this parameter's</span>
<span class="sd">        instantiate value up to date (dynamic parameters</span>
<span class="sd">        must be instantiated).</span>

<span class="sd">        If val is dynamic, initialize it as a generator.</span>
<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Dynamic</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__set__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>

        <span class="n">dynamic</span> <span class="o">=</span> <span class="n">callable</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dynamic</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_generator</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_instantiate</span><span class="p">(</span><span class="n">dynamic</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_produce_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">gen</span><span class="p">,</span><span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return a value from gen.</span>

<span class="sd">        If there is no time_fn, then a new value will be returned</span>
<span class="sd">        (i.e. gen will be asked to produce a new value).</span>

<span class="sd">        If force is True, or the value of time_fn() is different from</span>
<span class="sd">        what it was was last time produce_value was called, a new</span>
<span class="sd">        value will be produced and returned. Otherwise, the last value</span>
<span class="sd">        gen produced will be returned.</span>
<span class="sd">        """</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span><span class="s2">"_Dynamic_time_fn"</span><span class="p">):</span>
            <span class="n">time_fn</span> <span class="o">=</span> <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_time_fn</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">time_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_fn</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">time_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_dependent</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">produce_value</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
            <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_last</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="n">time</span> <span class="o">=</span> <span class="n">time_fn</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">force</span> <span class="ow">or</span> <span class="n">time</span><span class="o">!=</span><span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_time</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">produce_value</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
                <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_last</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_time</span> <span class="o">=</span> <span class="n">time</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_last</span>

        <span class="k">return</span> <span class="n">value</span>


    <span class="k">def</span> <span class="nf">_value_is_dynamic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return True if the parameter is actually dynamic (i.e. the</span>
<span class="sd">        value is being generated).</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="nb">hasattr</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">Dynamic</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="p">),</span><span class="s1">'_Dynamic_last'</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_inspect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""Return the last generated value for this parameter."""</span>
        <span class="n">gen</span><span class="o">=</span><span class="nb">super</span><span class="p">(</span><span class="n">Dynamic</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span><span class="s1">'_Dynamic_last'</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_last</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">gen</span>


    <span class="k">def</span> <span class="nf">_force</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""Force a new value to be generated, and return it."""</span>
        <span class="n">gen</span><span class="o">=</span><span class="nb">super</span><span class="p">(</span><span class="n">Dynamic</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span><span class="s1">'_Dynamic_last'</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_produce_value</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">gen</span></div>


<span class="kn">import</span> <span class="nn">numbers</span>
<span class="k">def</span> <span class="nf">_is_number</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">):</span> <span class="k">return</span> <span class="kc">True</span>
    <span class="c1"># The extra check is for classes that behave like numbers, such as those</span>
    <span class="c1"># found in numpy, gmpy, etc.</span>
    <span class="k">elif</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">'__int__'</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">'__add__'</span><span class="p">)):</span> <span class="k">return</span> <span class="kc">True</span>
    <span class="c1"># This is for older versions of gmpy</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">'qdiv'</span><span class="p">):</span> <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>


<span class="k">def</span> <span class="nf">identity_hook</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">):</span> <span class="k">return</span> <span class="n">val</span>

<div class="viewcode-block" id="get_soft_bounds"><a class="viewcode-back" href="../../reference.html#param.__init__.get_soft_bounds">[docs]</a><span class="k">def</span> <span class="nf">get_soft_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">softbounds</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    For each soft bound (upper and lower), if there is a defined bound</span>
<span class="sd">    (not equal to None) and does not exceed the hard bound, then it is</span>
<span class="sd">    returned. Otherwise it defaults to the hard bound. The hard bound</span>
<span class="sd">    could still be None.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hl</span><span class="p">,</span> <span class="n">hu</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hl</span><span class="p">,</span> <span class="n">hu</span> <span class="o">=</span> <span class="n">bounds</span>

    <span class="k">if</span> <span class="n">softbounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sl</span><span class="p">,</span> <span class="n">su</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sl</span><span class="p">,</span> <span class="n">su</span> <span class="o">=</span> <span class="n">softbounds</span>

    <span class="k">if</span> <span class="n">sl</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">hl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">sl</span><span class="o">&lt;</span><span class="n">hl</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">hl</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">sl</span>

    <span class="k">if</span> <span class="n">su</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">hu</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">su</span><span class="o">&gt;</span><span class="n">hu</span><span class="p">):</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">hu</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">su</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span></div>


<div class="viewcode-block" id="Number"><a class="viewcode-back" href="../../reference.html#param.__init__.Number">[docs]</a><span class="k">class</span> <span class="nc">Number</span><span class="p">(</span><span class="n">Dynamic</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    A numeric Dynamic Parameter, with a default value and optional bounds.</span>

<span class="sd">    There are two types of bounds: ``bounds`` and</span>
<span class="sd">    ``softbounds``.  ``bounds`` are hard bounds: the parameter must</span>
<span class="sd">    have a value within the specified range.  The default bounds are</span>
<span class="sd">    (None,None), meaning there are actually no hard bounds.  One or</span>
<span class="sd">    both bounds can be set by specifying a value</span>
<span class="sd">    (e.g. bounds=(None,10) means there is no lower bound, and an upper</span>
<span class="sd">    bound of 10). Bounds are inclusive by default, but exclusivity</span>
<span class="sd">    can be specified for each bound by setting inclusive_bounds</span>
<span class="sd">    (e.g. inclusive_bounds=(True,False) specifies an exclusive upper</span>
<span class="sd">    bound).</span>

<span class="sd">    Number is also a type of Dynamic parameter, so its value</span>
<span class="sd">    can be set to a callable to get a dynamically generated</span>
<span class="sd">    number (see Dynamic).</span>

<span class="sd">    When not being dynamically generated, bounds are checked when a</span>
<span class="sd">    Number is created or set. Using a default value outside the hard</span>
<span class="sd">    bounds, or one that is not numeric, results in an exception. When</span>
<span class="sd">    being dynamically generated, bounds are checked when the value</span>
<span class="sd">    of a Number is requested. A generated value that is not numeric,</span>
<span class="sd">    or is outside the hard bounds, results in an exception.</span>

<span class="sd">    As a special case, if allow_None=True (which is true by default if</span>
<span class="sd">    the parameter has a default of None when declared) then a value</span>
<span class="sd">    of None is also allowed.</span>

<span class="sd">    A separate function set_in_bounds() is provided that will</span>
<span class="sd">    silently crop the given value into the legal range, for use</span>
<span class="sd">    in, for instance, a GUI.</span>

<span class="sd">    ``softbounds`` are present to indicate the typical range of</span>
<span class="sd">    the parameter, but are not enforced. Setting the soft bounds</span>
<span class="sd">    allows, for instance, a GUI to know what values to display on</span>
<span class="sd">    sliders for the Number.</span>

<span class="sd">    Example of creating a Number::</span>

<span class="sd">      AB = Number(default=0.5, bounds=(None,10), softbounds=(0,1), doc='Distance from A to B.')</span>

<span class="sd">    """</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'bounds'</span><span class="p">,</span> <span class="s1">'softbounds'</span><span class="p">,</span> <span class="s1">'inclusive_bounds'</span><span class="p">,</span> <span class="s1">'set_hook'</span><span class="p">,</span> <span class="s1">'step'</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">softbounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">inclusive_bounds</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">),</span> <span class="n">step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Initialize this parameter object and store the bounds.</span>

<span class="sd">        Non-dynamic default values are checked against the bounds.</span>
<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Number</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_hook</span> <span class="o">=</span> <span class="n">identity_hook</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inclusive_bounds</span> <span class="o">=</span> <span class="n">inclusive_bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">softbounds</span> <span class="o">=</span> <span class="n">softbounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="n">step</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">objtype</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Same as the superclass's __get__, but if the value was</span>
<span class="sd">        dynamically generated, check the bounds.</span>
<span class="sd">        """</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">objtype</span><span class="p">)</span>
        <span class="c1"># CEBALERT: results in extra lookups (_value_is_dynamic() is</span>
        <span class="c1"># also looking up 'result' - should just pass it in). Note</span>
        <span class="c1"># that this method is called often.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value_is_dynamic</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">objtype</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

<div class="viewcode-block" id="Number.set_in_bounds"><a class="viewcode-back" href="../../reference.html#param.__init__.Number.set_in_bounds">[docs]</a>    <span class="k">def</span> <span class="nf">set_in_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Set to the given value, but cropped to be within the legal bounds.</span>
<span class="sd">        All objects are accepted, and no exceptions will be raised.  See</span>
<span class="sd">        crop_to_bounds for details on how cropping is done.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="n">bounded_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crop_to_bounds</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bounded_val</span> <span class="o">=</span> <span class="n">val</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__set__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">bounded_val</span><span class="p">)</span></div>

    <span class="c1"># CEBERRORALERT: doesn't take account of exclusive bounds; see</span>
    <span class="c1"># https://github.com/ioam/param/issues/80.</span>
<div class="viewcode-block" id="Number.crop_to_bounds"><a class="viewcode-back" href="../../reference.html#param.__init__.Number.crop_to_bounds">[docs]</a>    <span class="k">def</span> <span class="nf">crop_to_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return the given value cropped to be within the hard bounds</span>
<span class="sd">        for this parameter.</span>

<span class="sd">        If a numeric value is passed in, check it is within the hard</span>
<span class="sd">        bounds. If it is larger than the high bound, return the high</span>
<span class="sd">        bound. If it's smaller, return the low bound. In either case, the</span>
<span class="sd">        returned value could be None.  If a non-numeric value is passed</span>
<span class="sd">        in, set to be the default value (which could be None).  In no</span>
<span class="sd">        case is an exception raised; all values are accepted.</span>
<span class="sd">        """</span>
        <span class="c1"># Currently, values outside the bounds are silently cropped to</span>
        <span class="c1"># be inside the bounds; it may be appropriate to add a warning</span>
        <span class="c1"># in such cases.</span>
        <span class="k">if</span> <span class="n">_is_number</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">val</span>
            <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span>
            <span class="k">if</span> <span class="n">vmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="n">vmin</span><span class="p">:</span>
                    <span class="k">return</span>  <span class="n">vmin</span>

            <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="n">vmax</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">vmax</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">val</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># non-numeric value sent in: reverts to default value</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span>

        <span class="k">return</span> <span class="n">val</span></div>

    <span class="k">def</span> <span class="nf">_validate_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">inclusive_bounds</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">)</span> <span class="ow">or</span> <span class="n">callable</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="n">incmin</span><span class="p">,</span> <span class="n">incmax</span> <span class="o">=</span> <span class="n">inclusive_bounds</span>
        <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">incmax</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span> <span class="o">&lt;=</span> <span class="n">vmax</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Parameter </span><span class="si">%r</span><span class="s2"> must be at most </span><span class="si">%s</span><span class="s2">, "</span>
                                     <span class="s2">"not </span><span class="si">%s</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="n">vmax</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Parameter </span><span class="si">%r</span><span class="s2"> must be less than </span><span class="si">%s</span><span class="s2">, "</span>
                                     <span class="s2">"not </span><span class="si">%s</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">vmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">incmin</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span> <span class="o">&gt;=</span> <span class="n">vmin</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Parameter </span><span class="si">%r</span><span class="s2"> must be at least </span><span class="si">%s</span><span class="s2">, "</span>
                                     <span class="s2">"not </span><span class="si">%s</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="n">vmin</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Parameter </span><span class="si">%r</span><span class="s2"> must be greater than </span><span class="si">%s</span><span class="s2">, "</span>
                                     <span class="s2">"not </span><span class="si">%s</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_validate_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">allow_None</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="n">callable</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_number</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Parameter </span><span class="si">%r</span><span class="s2"> only takes numeric values, "</span>
                             <span class="s2">"not type </span><span class="si">%r</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_validate_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">step</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">_is_number</span><span class="p">(</span><span class="n">step</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Step parameter can only be None or a "</span>
                             <span class="s2">"numeric value, not type </span><span class="si">%r</span><span class="s2">."</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">step</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Checks that the value is numeric and that it is within the hard</span>
<span class="sd">        bounds; if not, an exception is raised.</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_value</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_step</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_bounds</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inclusive_bounds</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_soft_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">get_soft_bounds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">softbounds</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">'step'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>
            <span class="n">state</span><span class="p">[</span><span class="s1">'step'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></div>



<div class="viewcode-block" id="Integer"><a class="viewcode-back" href="../../reference.html#param.__init__.Integer">[docs]</a><span class="k">class</span> <span class="nc">Integer</span><span class="p">(</span><span class="n">Number</span><span class="p">):</span>
    <span class="sd">"""Numeric Parameter required to be an Integer"""</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="n">Number</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">allow_None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Integer parameter </span><span class="si">%r</span><span class="s2"> must be an integer, "</span>
                             <span class="s2">"not type </span><span class="si">%r</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_validate_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">step</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Step parameter can only be None or an "</span>
                             <span class="s2">"integer value, not type </span><span class="si">%r</span><span class="s2">"</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">step</span><span class="p">))</span></div>



<div class="viewcode-block" id="Magnitude"><a class="viewcode-back" href="../../reference.html#param.__init__.Magnitude">[docs]</a><span class="k">class</span> <span class="nc">Magnitude</span><span class="p">(</span><span class="n">Number</span><span class="p">):</span>
    <span class="sd">"""Numeric Parameter required to be in the range [0.0-1.0]."""</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">softbounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="n">Number</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">softbounds</span><span class="o">=</span><span class="n">softbounds</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="Boolean"><a class="viewcode-back" href="../../reference.html#param.__init__.Boolean">[docs]</a><span class="k">class</span> <span class="nc">Boolean</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""Binary or tristate Boolean Parameter."""</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'bounds'</span><span class="p">]</span>

    <span class="c1"># CB: bounds have no effect; see https://github.com/holoviz/param/issues/82</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Boolean</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">allow_None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">allow_None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Boolean parameter </span><span class="si">%r</span><span class="s2"> only takes a "</span>
                                 <span class="s2">"Boolean value or None, not </span><span class="si">%s</span><span class="s2">."</span>
                                 <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Boolean parameter </span><span class="si">%r</span><span class="s2"> must be True or False, "</span>
                             <span class="s2">"not </span><span class="si">%s</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span></div>



<div class="viewcode-block" id="Tuple"><a class="viewcode-back" href="../../reference.html#param.__init__.Tuple">[docs]</a><span class="k">class</span> <span class="nc">Tuple</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""A tuple Parameter (e.g. ('a',7.6,[3,5])) with a fixed tuple length."""</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'length'</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Initialize a tuple parameter with a fixed length (number of</span>
<span class="sd">        elements).  The length is determined by the initial default</span>
<span class="sd">        value, if any, and must be supplied explicitly otherwise.  The</span>
<span class="sd">        length is not allowed to change after instantiation.</span>
<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Tuple</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">length</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">length</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"</span><span class="si">%s</span><span class="s2">: length must be specified if no default is supplied."</span> <span class="o">%</span>
                             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">allow_None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">allow_None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Tuple parameter </span><span class="si">%r</span><span class="s2"> only takes a tuple value, "</span>
                             <span class="s2">"not </span><span class="si">%r</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_validate_length</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="n">length</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Tuple parameter </span><span class="si">%r</span><span class="s2"> is not of the correct "</span>
                             <span class="s2">"length (</span><span class="si">%d</span><span class="s2"> instead of </span><span class="si">%d</span><span class="s2">)."</span> <span class="o">%</span>
                             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">length</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_value</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_length</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>

<div class="viewcode-block" id="Tuple.serialize"><a class="viewcode-back" href="../../reference.html#param.__init__.Tuple.serialize">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="c1"># As JSON has no tuple representation</span></div>

<div class="viewcode-block" id="Tuple.deserialize"><a class="viewcode-back" href="../../reference.html#param.__init__.Tuple.deserialize">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="c1"># As JSON has no tuple representation</span></div></div>


<div class="viewcode-block" id="NumericTuple"><a class="viewcode-back" href="../../reference.html#param.__init__.NumericTuple">[docs]</a><span class="k">class</span> <span class="nc">NumericTuple</span><span class="p">(</span><span class="n">Tuple</span><span class="p">):</span>
    <span class="sd">"""A numeric tuple Parameter (e.g. (4.5,7.6,3)) with a fixed tuple length."""</span>

    <span class="k">def</span> <span class="nf">_validate_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">allow_None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NumericTuple</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_validate_value</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">allow_None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">_is_number</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"NumericTuple parameter </span><span class="si">%r</span><span class="s2"> only takes numeric "</span>
                             <span class="s2">"values, not type </span><span class="si">%r</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span></div>


<div class="viewcode-block" id="XYCoordinates"><a class="viewcode-back" href="../../reference.html#param.__init__.XYCoordinates">[docs]</a><span class="k">class</span> <span class="nc">XYCoordinates</span><span class="p">(</span><span class="n">NumericTuple</span><span class="p">):</span>
    <span class="sd">"""A NumericTuple for an X,Y coordinate."""</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">XYCoordinates</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span></div>


<div class="viewcode-block" id="Callable"><a class="viewcode-back" href="../../reference.html#param.__init__.Callable">[docs]</a><span class="k">class</span> <span class="nc">Callable</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter holding a value that is a callable object, such as a function.</span>

<span class="sd">    A keyword argument instantiate=True should be provided when a</span>
<span class="sd">    function object is used that might have state.  On the other hand,</span>
<span class="sd">    regular standalone functions cannot be deepcopied as of Python</span>
<span class="sd">    2.4, so instantiate must be False for those values.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="nf">_validate_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">allow_None</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="n">callable</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Callable parameter </span><span class="si">%r</span><span class="s2"> only takes a callable object, "</span>
                         <span class="s2">"not objects of type </span><span class="si">%r</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)))</span></div>


<div class="viewcode-block" id="Action"><a class="viewcode-back" href="../../reference.html#param.__init__.Action">[docs]</a><span class="k">class</span> <span class="nc">Action</span><span class="p">(</span><span class="n">Callable</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    A user-provided function that can be invoked like a class or object method using ().</span>
<span class="sd">    In a GUI, this might be mapped to a button, but it can be invoked directly as well.</span>
<span class="sd">    """</span></div>
<span class="c1"># Currently same implementation as Callable, but kept separate to allow different handling in GUIs</span>


<span class="k">def</span> <span class="nf">_is_abstract</span><span class="p">(</span><span class="n">class_</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">class_</span><span class="o">.</span><span class="n">abstract</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="c1"># CEBALERT: this should be a method of ClassSelector.</span>
<div class="viewcode-block" id="concrete_descendents"><a class="viewcode-back" href="../../reference.html#param.__init__.concrete_descendents">[docs]</a><span class="k">def</span> <span class="nf">concrete_descendents</span><span class="p">(</span><span class="n">parentclass</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Return a dictionary containing all subclasses of the specified</span>
<span class="sd">    parentclass, including the parentclass.  Only classes that are</span>
<span class="sd">    defined in scripts that have been run or modules that have been</span>
<span class="sd">    imported are included, so the caller will usually first do ``from</span>
<span class="sd">    package import *``.</span>

<span class="sd">    Only non-abstract classes will be included.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">c</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">descendents</span><span class="p">(</span><span class="n">parentclass</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_abstract</span><span class="p">(</span><span class="n">c</span><span class="p">))</span></div>


<div class="viewcode-block" id="Composite"><a class="viewcode-back" href="../../reference.html#param.__init__.Composite">[docs]</a><span class="k">class</span> <span class="nc">Composite</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    A Parameter that is a composite of a set of other attributes of the class.</span>

<span class="sd">    The constructor argument 'attribs' takes a list of attribute</span>
<span class="sd">    names, which may or may not be Parameters.  Getting the parameter</span>
<span class="sd">    returns a list of the values of the constituents of the composite,</span>
<span class="sd">    in the order specified.  Likewise, setting the parameter takes a</span>
<span class="sd">    sequence of values and sets the value of the constituent</span>
<span class="sd">    attributes.</span>

<span class="sd">    This Parameter type has not been tested with watchers and</span>
<span class="sd">    dependencies, and may not support them properly.</span>
<span class="sd">    """</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'attribs'</span><span class="p">,</span> <span class="s1">'objtype'</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">attribs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attribs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Composite</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attribs</span> <span class="o">=</span> <span class="n">attribs</span>

    <span class="k">def</span> <span class="fm">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">objtype</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return the values of all the attribs, as a list.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">objtype</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribs</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribs</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_validate_attribs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">attribs</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">attribs</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Compound parameter </span><span class="si">%r</span><span class="s2"> got the wrong number "</span>
                         <span class="s2">"of values (needed </span><span class="si">%d</span><span class="s2">, but got </span><span class="si">%d</span><span class="s2">)."</span> <span class="o">%</span>
                         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">attribs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_attribs</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_post_setter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribs</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objtype</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribs</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span></div>


<div class="viewcode-block" id="SelectorBase"><a class="viewcode-back" href="../../reference.html#param.__init__.SelectorBase">[docs]</a><span class="k">class</span> <span class="nc">SelectorBase</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value must be chosen from a list of possibilities.</span>

<span class="sd">    Subclasses must implement get_range().</span>
<span class="sd">    """</span>

    <span class="n">__abstract</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">get_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"get_range() must be implemented in subclasses."</span><span class="p">)</span></div>


<div class="viewcode-block" id="Selector"><a class="viewcode-back" href="../../reference.html#param.__init__.Selector">[docs]</a><span class="k">class</span> <span class="nc">Selector</span><span class="p">(</span><span class="n">SelectorBase</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value must be one object from a list of possible objects.</span>

<span class="sd">    By default, if no default is specfied, picks the first object from</span>
<span class="sd">    the provided set of objects, as long as the objects are in an ordered</span>
<span class="sd">    data collection.</span>

<span class="sd">    check_on_set restricts the value to be among the current list of</span>
<span class="sd">    objects. By default, if objects are initially supplied,</span>
<span class="sd">    check_on_set is True, whereas if no objects are initially</span>
<span class="sd">    supplied, check_on_set is False. This can be overridden by</span>
<span class="sd">    explicitly specifying check_on_set initially.</span>

<span class="sd">    If check_on_set is True (either because objects are supplied</span>
<span class="sd">    initially, or because it is explicitly specified), the default</span>
<span class="sd">    (initial) value must be among the list of objects (unless the</span>
<span class="sd">    default value is None).</span>

<span class="sd">    The list of objects can be supplied as a list (appropriate for</span>
<span class="sd">    selecting among a set of strings, or among a set of objects with a</span>
<span class="sd">    "name" parameter), or as a (preferably ordered) dictionary from</span>
<span class="sd">    names to objects.  If a dictionary is supplied, the objects</span>
<span class="sd">    will need to be hashable so that their names can be looked</span>
<span class="sd">    up from the object value.</span>
<span class="sd">    """</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'objects'</span><span class="p">,</span> <span class="s1">'compute_default_fn'</span><span class="p">,</span> <span class="s1">'check_on_set'</span><span class="p">,</span> <span class="s1">'names'</span><span class="p">]</span>

    <span class="c1"># Selector is usually used to allow selection from a list of</span>
    <span class="c1"># existing objects, therefore instantiate is False by default.</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">instantiate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">compute_default_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">check_on_set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">allow_None</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">empty_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>

        <span class="n">autodefault</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">objects</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_ordered_dict</span><span class="p">(</span><span class="n">objects</span><span class="p">):</span>
                <span class="n">autodefault</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">main</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">"Parameter default value is arbitrary due to "</span>
                                   <span class="s2">"dictionaries prior to Python 3.6 not being "</span>
                                   <span class="s2">"ordered; should use an ordered dict or "</span>
                                   <span class="s2">"supply an explicit default value."</span><span class="p">)</span>
                <span class="n">autodefault</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">autodefault</span> <span class="o">=</span> <span class="n">objects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">default</span> <span class="o">=</span> <span class="n">autodefault</span> <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">empty_default</span> <span class="ow">and</span> <span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">default</span>

        <span class="k">if</span> <span class="n">objects</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">objects</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">collections_abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">objects</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="n">objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_default_fn</span> <span class="o">=</span> <span class="n">compute_default_fn</span>

        <span class="k">if</span> <span class="n">check_on_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_on_set</span> <span class="o">=</span> <span class="n">check_on_set</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_on_set</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_on_set</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">Selector</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">instantiate</span><span class="o">=</span><span class="n">instantiate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="c1"># Required as Parameter sets allow_None=True if default is None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="o">=</span> <span class="n">allow_None</span>
        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_on_set</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>

    <span class="c1"># CBNOTE: if the list of objects is changed, the current value for</span>
    <span class="c1"># this parameter in existing POs could be out of the new range.</span>

<div class="viewcode-block" id="Selector.compute_default"><a class="viewcode-back" href="../../reference.html#param.__init__.Selector.compute_default">[docs]</a>    <span class="k">def</span> <span class="nf">compute_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        If this parameter's compute_default_fn is callable, call it</span>
<span class="sd">        and store the result in self.default.</span>

<span class="sd">        Also removes None from the list of objects (if the default is</span>
<span class="sd">        no longer None).</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">compute_default_fn</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_default_fn</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        val must be None or one of the objects in self.objects.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_on_set</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_value_is_in_objects</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="c1"># This method can be called before __init__ has called</span>
            <span class="c1"># super's __init__, so there may not be any name set yet.</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"name"</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="n">attrib_name</span> <span class="o">=</span> <span class="s2">" "</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">attrib_name</span> <span class="o">=</span> <span class="s2">""</span>

            <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">limiter</span> <span class="o">=</span> <span class="s1">']'</span>
            <span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">length</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">:</span>
                    <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">limiter</span> <span class="o">=</span> <span class="s1">', ...]'</span>
                    <span class="k">break</span>
            <span class="n">items</span> <span class="o">=</span> <span class="s1">'['</span> <span class="o">+</span> <span class="s1">', '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">+</span> <span class="n">limiter</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"</span><span class="si">%s</span><span class="s2"> not in parameter</span><span class="si">%s</span><span class="s2">'s list of possible objects, "</span>
                             <span class="s2">"valid options include </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">attrib_name</span><span class="p">,</span> <span class="n">items</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_ensure_value_is_in_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Make sure that the provided value is present on the objects list.</span>
<span class="sd">        Subclasses can override if they support multiple items on a list,</span>
<span class="sd">        to check each item instead.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

<div class="viewcode-block" id="Selector.get_range"><a class="viewcode-back" href="../../reference.html#param.__init__.Selector.get_range">[docs]</a>    <span class="k">def</span> <span class="nf">get_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return the possible objects to which this parameter could be set.</span>

<span class="sd">        (Returns the dictionary {object.name:object}.)</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="n">named_objs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ObjectSelector"><a class="viewcode-back" href="../../reference.html#param.__init__.ObjectSelector">[docs]</a><span class="k">class</span> <span class="nc">ObjectSelector</span><span class="p">(</span><span class="n">Selector</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Deprecated. Same as Selector, but with a different constructor for</span>
<span class="sd">    historical reasons.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">objects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ObjectSelector</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">objects</span><span class="o">=</span><span class="n">objects</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
                                            <span class="n">empty_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="ClassSelector"><a class="viewcode-back" href="../../reference.html#param.__init__.ClassSelector">[docs]</a><span class="k">class</span> <span class="nc">ClassSelector</span><span class="p">(</span><span class="n">SelectorBase</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter allowing selection of either a subclass or an instance of a given set of classes.</span>
<span class="sd">    By default, requires an instance, but if is_instance=False, accepts a class instead.</span>
<span class="sd">    Both class and instance values respect the instantiate slot, though it matters only</span>
<span class="sd">    for is_instance=True.</span>
<span class="sd">    """</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'class_'</span><span class="p">,</span> <span class="s1">'is_instance'</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">class_</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">instantiate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">is_instance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_</span> <span class="o">=</span> <span class="n">class_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_instance</span> <span class="o">=</span> <span class="n">is_instance</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ClassSelector</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span><span class="n">instantiate</span><span class="o">=</span><span class="n">instantiate</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ClassSelector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_class_</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_instance</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_class_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">class_</span><span class="p">,</span> <span class="n">is_instance</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">class_</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">class_name</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'(</span><span class="si">%s</span><span class="s1">)'</span> <span class="o">%</span> <span class="s1">', '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">class_</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">class_name</span> <span class="o">=</span> <span class="n">class_</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">param_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">if</span> <span class="n">is_instance</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">class_</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">"</span><span class="si">%s</span><span class="s2"> parameter </span><span class="si">%r</span><span class="s2"> value must be an instance of </span><span class="si">%s</span><span class="s2">, not </span><span class="si">%r</span><span class="s2">."</span> <span class="o">%</span>
                    <span class="p">(</span><span class="n">param_cls</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">class_name</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">class_</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">"</span><span class="si">%s</span><span class="s2"> parameter </span><span class="si">%r</span><span class="s2"> must be a subclass of </span><span class="si">%s</span><span class="s2">, not </span><span class="si">%r</span><span class="s2">."</span> <span class="o">%</span>
                    <span class="p">(</span><span class="n">param_cls</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">class_name</span><span class="p">,</span> <span class="n">val</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>

<div class="viewcode-block" id="ClassSelector.get_range"><a class="viewcode-back" href="../../reference.html#param.__init__.ClassSelector.get_range">[docs]</a>    <span class="k">def</span> <span class="nf">get_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return the possible types for this parameter's value.</span>

<span class="sd">        (I.e. return {name: &lt;class&gt;} for all classes that are</span>
<span class="sd">        concrete_descendents() of self.class_.)</span>

<span class="sd">        Only classes from modules that have been imported are added</span>
<span class="sd">        (see concrete_descendents()).</span>
<span class="sd">        """</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_</span><span class="p">,)</span>
        <span class="n">all_classes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
            <span class="n">all_classes</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">concrete_descendents</span><span class="p">(</span><span class="bp">cls</span><span class="p">))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">class_</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">class_</span> <span class="ow">in</span> <span class="n">all_classes</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="s1">'None'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">d</span></div></div>


<div class="viewcode-block" id="List"><a class="viewcode-back" href="../../reference.html#param.__init__.List">[docs]</a><span class="k">class</span> <span class="nc">List</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value is a list of objects, usually of a specified type.</span>

<span class="sd">    The bounds allow a minimum and/or maximum length of</span>
<span class="sd">    list to be enforced.  If the item_type is non-None, all</span>
<span class="sd">    items in the list are checked to be of that type.</span>

<span class="sd">    `class_` is accepted as an alias for `item_type`, but is</span>
<span class="sd">    deprecated due to conflict with how the `class_` slot is</span>
<span class="sd">    used in Selector classes.</span>
<span class="sd">    """</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'bounds'</span><span class="p">,</span> <span class="s1">'item_type'</span><span class="p">,</span> <span class="s1">'class_'</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[],</span> <span class="n">class_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">item_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">instantiate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_type</span> <span class="o">=</span> <span class="n">item_type</span> <span class="ow">or</span> <span class="n">class_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="n">Parameter</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">instantiate</span><span class="o">=</span><span class="n">instantiate</span><span class="p">,</span>
                           <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Checks that the value is numeric and that it is within the hard</span>
<span class="sd">        bounds; if not, an exception is raised.</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_value</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_bounds</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_item_type</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_type</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">bounds</span><span class="p">):</span>
        <span class="s2">"Checks that the list is of the right length and has the right contents."</span>
        <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="n">min_length</span><span class="p">,</span> <span class="n">max_length</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">min_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">max_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">min_length</span> <span class="o">&lt;=</span> <span class="n">l</span> <span class="o">&lt;=</span> <span class="n">max_length</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"</span><span class="si">%s</span><span class="s2">: list length must be between </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2"> (inclusive)"</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">min_length</span><span class="p">,</span><span class="n">max_length</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">min_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">min_length</span> <span class="o">&lt;=</span> <span class="n">l</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"</span><span class="si">%s</span><span class="s2">: list length must be at least </span><span class="si">%s</span><span class="s2">."</span>
                                 <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">min_length</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">max_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">l</span> <span class="o">&lt;=</span> <span class="n">max_length</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"</span><span class="si">%s</span><span class="s2">: list length must be at most </span><span class="si">%s</span><span class="s2">."</span>
                                 <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">max_length</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_validate_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">allow_None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"List parameter </span><span class="si">%r</span><span class="s2"> must be a list, not an object of type </span><span class="si">%s</span><span class="s2">."</span>
                             <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_validate_item_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">item_type</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">item_type</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">item_type</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"List parameter </span><span class="si">%r</span><span class="s2"> items must be instances "</span>
                            <span class="s2">"of type </span><span class="si">%r</span><span class="s2">, not </span><span class="si">%r</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">item_type</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span></div>


<div class="viewcode-block" id="HookList"><a class="viewcode-back" href="../../reference.html#param.__init__.HookList">[docs]</a><span class="k">class</span> <span class="nc">HookList</span><span class="p">(</span><span class="n">List</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value is a list of callable objects.</span>

<span class="sd">    This type of List Parameter is typically used to provide a place</span>
<span class="sd">    for users to register a set of commands to be called at a</span>
<span class="sd">    specified place in some sequence of processing steps.</span>
<span class="sd">    """</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'class_'</span><span class="p">,</span> <span class="s1">'bounds'</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_validate_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">allow_None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">HookList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_validate_value</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">allow_None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"HookList parameter </span><span class="si">%r</span><span class="s2"> items must be callable, "</span>
                             <span class="s2">"not </span><span class="si">%r</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span></div>


<div class="viewcode-block" id="Dict"><a class="viewcode-back" href="../../reference.html#param.__init__.Dict">[docs]</a><span class="k">class</span> <span class="nc">Dict</span><span class="p">(</span><span class="n">ClassSelector</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value is a dictionary.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Dict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span></div>


<div class="viewcode-block" id="Array"><a class="viewcode-back" href="../../reference.html#param.__init__.Array">[docs]</a><span class="k">class</span> <span class="nc">Array</span><span class="p">(</span><span class="n">ClassSelector</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value is a numpy array.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">ndarray</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Array</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">allow_None</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>

<div class="viewcode-block" id="Array.serialize"><a class="viewcode-back" href="../../reference.html#param.__init__.Array.serialize">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span></div>

<div class="viewcode-block" id="Array.deserialize"><a class="viewcode-back" href="../../reference.html#param.__init__.Array.deserialize">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">asarray</span>
        <span class="k">return</span> <span class="n">asarray</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DataFrame"><a class="viewcode-back" href="../../reference.html#param.__init__.DataFrame">[docs]</a><span class="k">class</span> <span class="nc">DataFrame</span><span class="p">(</span><span class="n">ClassSelector</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value is a pandas DataFrame.</span>

<span class="sd">    The structure of the DataFrame can be constrained by the rows and</span>
<span class="sd">    columns arguments:</span>

<span class="sd">    rows: If specified, may be a number or an integer bounds tuple to</span>
<span class="sd">    constrain the allowable number of rows.</span>

<span class="sd">    columns: If specified, may be a number, an integer bounds tuple, a</span>
<span class="sd">    list or a set. If the argument is numeric, constrains the number of</span>
<span class="sd">    columns using the same semantics as used for rows. If either a list</span>
<span class="sd">    or set of strings, the column names will be validated. If a set is</span>
<span class="sd">    used, the supplied DataFrame must contain the specified columns and</span>
<span class="sd">    if a list is given, the supplied DataFrame must contain exactly the</span>
<span class="sd">    same columns and in the same order and no other columns.</span>
<span class="sd">    """</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'rows'</span><span class="p">,</span> <span class="s1">'columns'</span><span class="p">,</span> <span class="s1">'ordered'</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span> <span class="k">as</span> <span class="n">pdDFrame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="n">rows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ordered</span> <span class="o">=</span> <span class="n">ordered</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DataFrame</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">pdDFrame</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_length_bounds_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s1">'</span><span class="si">{name}</span><span class="s1"> length </span><span class="si">{length}</span><span class="s1"> does not match declared bounds of </span><span class="si">{bounds}</span><span class="s1">'</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">bounds</span> <span class="o">!=</span> <span class="n">length</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span>
        <span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="n">failure</span> <span class="o">=</span> <span class="p">((</span><span class="n">lower</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">length</span> <span class="o">&lt;</span> <span class="n">lower</span><span class="p">))</span>
                   <span class="ow">or</span> <span class="p">(</span><span class="n">upper</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">length</span> <span class="o">&gt;</span> <span class="n">upper</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">failure</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DataFrame</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="nb">set</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Columns cannot be ordered when specified as a set'</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span>
              <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span> <span class="c1"># Numeric bounds tuple</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_length_bounds_check</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="s1">'Columns'</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">set</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ordered</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered</span>
            <span class="n">difference</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">val</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">difference</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">'Provided DataFrame columns </span><span class="si">{found}</span><span class="s1"> does not contain required columns </span><span class="si">{expected}</span><span class="s1">'</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">found</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">expected</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_length_bounds_check</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="s1">'Column'</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">'Provided DataFrame columns </span><span class="si">{found}</span><span class="s1"> must exactly match </span><span class="si">{expected}</span><span class="s1">'</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">found</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">expected</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_length_bounds_check</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="s1">'Row'</span><span class="p">)</span>

<div class="viewcode-block" id="DataFrame.serialize"><a class="viewcode-back" href="../../reference.html#param.__init__.DataFrame.serialize">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">'records'</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.deserialize"><a class="viewcode-back" href="../../reference.html#param.__init__.DataFrame.deserialize">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span> <span class="k">as</span> <span class="n">pdDFrame</span>
        <span class="k">return</span> <span class="n">pdDFrame</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Series"><a class="viewcode-back" href="../../reference.html#param.__init__.Series">[docs]</a><span class="k">class</span> <span class="nc">Series</span><span class="p">(</span><span class="n">ClassSelector</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value is a pandas Series.</span>

<span class="sd">    The structure of the Series can be constrained by the rows argument</span>
<span class="sd">    which may be a number or an integer bounds tuple to constrain the</span>
<span class="sd">    allowable number of rows.</span>
<span class="sd">    """</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'rows'</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_None</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">Series</span> <span class="k">as</span> <span class="n">pdSeries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="n">rows</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Series</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">pdSeries</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">allow_None</span><span class="o">=</span><span class="n">allow_None</span><span class="p">,</span>
                                    <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_length_bounds_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s1">'</span><span class="si">{name}</span><span class="s1"> length </span><span class="si">{length}</span><span class="s1"> does not match declared bounds of </span><span class="si">{bounds}</span><span class="s1">'</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">bounds</span> <span class="o">!=</span> <span class="n">length</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span>
        <span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="n">failure</span> <span class="o">=</span> <span class="p">((</span><span class="n">lower</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">length</span> <span class="o">&lt;</span> <span class="n">lower</span><span class="p">))</span>
                   <span class="ow">or</span> <span class="p">(</span><span class="n">upper</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">length</span> <span class="o">&gt;</span> <span class="n">upper</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">failure</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Series</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_length_bounds_check</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="s1">'Row'</span><span class="p">)</span></div>



<span class="c1"># For portable code:</span>
<span class="c1">#   - specify paths in unix (rather than Windows) style;</span>
<span class="c1">#   - use resolve_file_path() for paths to existing files to be read,</span>
<span class="c1">#   - use resolve_folder_path() for paths to existing folders to be read,</span>
<span class="c1">#     and normalize_path() for paths to new files to be written.</span>

<div class="viewcode-block" id="resolve_path"><a class="viewcode-back" href="../../reference.html#param.__init__.resolve_path">[docs]</a><span class="k">class</span> <span class="nc">resolve_path</span><span class="p">(</span><span class="n">ParameterizedFunction</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Find the path to an existing file, searching the paths specified</span>
<span class="sd">    in the search_paths parameter if the filename is not absolute, and</span>
<span class="sd">    converting a UNIX-style path to the current OS's format if</span>
<span class="sd">    necessary.</span>

<span class="sd">    To turn a supplied relative path into an absolute one, the path is</span>
<span class="sd">    appended to paths in the search_paths parameter, in order, until</span>
<span class="sd">    the file is found.</span>

<span class="sd">    An IOError is raised if the file is not found.</span>

<span class="sd">    Similar to Python's os.path.abspath(), except more search paths</span>
<span class="sd">    than just os.getcwd() can be used, and the file must exist.</span>
<span class="sd">    """</span>

    <span class="n">search_paths</span> <span class="o">=</span> <span class="n">List</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()],</span> <span class="n">pickle_default_value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">        Prepended to a non-relative path, in order, until a file is</span>
<span class="s2">        found."""</span><span class="p">)</span>

    <span class="n">path_to_file</span> <span class="o">=</span> <span class="n">Boolean</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pickle_default_value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">allow_None</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">        String specifying whether the path refers to a 'File' or a 'Folder'."""</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">ParamOverrides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">ftype</span> <span class="o">=</span> <span class="s2">"File"</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">path_to_file</span> <span class="ow">is</span> <span class="kc">True</span> \
            <span class="k">else</span> <span class="s2">"Folder"</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">path_to_file</span> <span class="ow">is</span> <span class="kc">False</span> <span class="k">else</span> <span class="s2">"Path"</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">search_paths</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">search_paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()]</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">p</span><span class="o">.</span><span class="n">path_to_file</span> <span class="ow">is</span> <span class="kc">None</span>  <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">))</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">path_to_file</span> <span class="ow">is</span> <span class="kc">True</span>  <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">))</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">path_to_file</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span> <span class="n">path</span><span class="p">))):</span>
                <span class="k">return</span> <span class="n">path</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">"</span><span class="si">%s</span><span class="s2"> '</span><span class="si">%s</span><span class="s2">' not found."</span> <span class="o">%</span> <span class="p">(</span><span class="n">ftype</span><span class="p">,</span><span class="n">path</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">paths_tried</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">search_paths</span><span class="p">:</span>
                <span class="n">try_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">prefix</span><span class="p">),</span> <span class="n">path</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">((</span><span class="n">p</span><span class="o">.</span><span class="n">path_to_file</span> <span class="ow">is</span> <span class="kc">None</span>  <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">try_path</span><span class="p">))</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">path_to_file</span> <span class="ow">is</span> <span class="kc">True</span>  <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">try_path</span><span class="p">))</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">path_to_file</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span> <span class="n">try_path</span><span class="p">))):</span>
                    <span class="k">return</span> <span class="n">try_path</span>

                <span class="n">paths_tried</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">try_path</span><span class="p">)</span>

            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="n">ftype</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">" was not found in the following place(s): "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">paths_tried</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"."</span><span class="p">)</span></div>


<div class="viewcode-block" id="normalize_path"><a class="viewcode-back" href="../../reference.html#param.__init__.normalize_path">[docs]</a><span class="k">class</span> <span class="nc">normalize_path</span><span class="p">(</span><span class="n">ParameterizedFunction</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Convert a UNIX-style path to the current OS's format,</span>
<span class="sd">    typically for creating a new file or directory.</span>

<span class="sd">    If the path is not already absolute, it will be made absolute</span>
<span class="sd">    (using the prefix parameter).</span>

<span class="sd">    Should do the same as Python's os.path.abspath(), except using</span>
<span class="sd">    prefix rather than os.getcwd).</span>
<span class="sd">    """</span>

    <span class="n">prefix</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="n">pickle_default_value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">        Prepended to the specified path, if that path is not</span>
<span class="s2">        absolute."""</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">ParamOverrides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">prefix</span><span class="p">),</span><span class="n">path</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>



<div class="viewcode-block" id="Path"><a class="viewcode-back" href="../../reference.html#param.__init__.Path">[docs]</a><span class="k">class</span> <span class="nc">Path</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter that can be set to a string specifying the path of a file or folder.</span>

<span class="sd">    The string should be specified in UNIX style, but it will be</span>
<span class="sd">    returned in the format of the user's operating system. Please use</span>
<span class="sd">    the Filename or Foldername classes if you require discrimination</span>
<span class="sd">    between the two possibilities.</span>

<span class="sd">    The specified path can be absolute, or relative to either:</span>

<span class="sd">    * any of the paths specified in the search_paths attribute (if</span>
<span class="sd">      search_paths is not None);</span>

<span class="sd">    or</span>

<span class="sd">    * any of the paths searched by resolve_path() (if search_paths</span>
<span class="sd">      is None).</span>
<span class="sd">    """</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'search_paths'</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">search_paths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">search_paths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">search_paths</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">search_paths</span> <span class="o">=</span> <span class="n">search_paths</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">path_to_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">search_paths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_paths</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">:</span>
                <span class="n">Parameterized</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">"</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">'None is not allowed'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_resolve</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">Parameterized</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">"</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">'</span><span class="si">%s</span><span class="s1">'</span><span class="p">,</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">objtype</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return an absolute, normalized path (see resolve_path).</span>
<span class="sd">        """</span>
        <span class="n">raw_path</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">raw_path</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve</span><span class="p">(</span><span class="n">raw_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># don't want to pickle the search_paths</span>
        <span class="n">state</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__getstate__</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">'search_paths'</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>
            <span class="n">state</span><span class="p">[</span><span class="s1">'search_paths'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">return</span> <span class="n">state</span></div>



<div class="viewcode-block" id="Filename"><a class="viewcode-back" href="../../reference.html#param.__init__.Filename">[docs]</a><span class="k">class</span> <span class="nc">Filename</span><span class="p">(</span><span class="n">Path</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter that can be set to a string specifying the path of a file.</span>

<span class="sd">    The string should be specified in UNIX style, but it will be</span>
<span class="sd">    returned in the format of the user's operating system.</span>

<span class="sd">    The specified path can be absolute, or relative to either:</span>

<span class="sd">    * any of the paths specified in the search_paths attribute (if</span>
<span class="sd">      search_paths is not None);</span>
<span class="sd">    or</span>

<span class="sd">    * any of the paths searched by resolve_path() (if search_paths</span>
<span class="sd">      is None).</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="nf">_resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">path_to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">search_paths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_paths</span><span class="p">)</span></div>


<div class="viewcode-block" id="Foldername"><a class="viewcode-back" href="../../reference.html#param.__init__.Foldername">[docs]</a><span class="k">class</span> <span class="nc">Foldername</span><span class="p">(</span><span class="n">Path</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter that can be set to a string specifying the path of a folder.</span>

<span class="sd">    The string should be specified in UNIX style, but it will be</span>
<span class="sd">    returned in the format of the user's operating system.</span>

<span class="sd">    The specified path can be absolute, or relative to either:</span>

<span class="sd">    * any of the paths specified in the search_paths attribute (if</span>
<span class="sd">      search_paths is not None);</span>
<span class="sd">    or</span>

<span class="sd">    * any of the paths searched by resolve_dir_path() (if search_paths</span>
<span class="sd">      is None).</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="nf">_resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">path_to_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">search_paths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_paths</span><span class="p">)</span></div>



<div class="viewcode-block" id="abbreviate_paths"><a class="viewcode-back" href="../../reference.html#param.__init__.abbreviate_paths">[docs]</a><span class="k">def</span> <span class="nf">abbreviate_paths</span><span class="p">(</span><span class="n">pathspec</span><span class="p">,</span><span class="n">named_paths</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Given a dict of (pathname,path) pairs, removes any prefix shared by all pathnames.</span>
<span class="sd">    Helps keep menu items short yet unambiguous.</span>
<span class="sd">    """</span>
    <span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">commonprefix</span><span class="p">,</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">sep</span>

    <span class="n">prefix</span> <span class="o">=</span> <span class="n">commonprefix</span><span class="p">([</span><span class="n">dirname</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">+</span><span class="n">sep</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">named_paths</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span><span class="o">+</span><span class="p">[</span><span class="n">pathspec</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="n">name</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">):],</span><span class="n">path</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">path</span> <span class="ow">in</span> <span class="n">named_paths</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span></div>



<div class="viewcode-block" id="FileSelector"><a class="viewcode-back" href="../../reference.html#param.__init__.FileSelector">[docs]</a><span class="k">class</span> <span class="nc">FileSelector</span><span class="p">(</span><span class="n">Selector</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Given a path glob, allows one file to be selected from those matching.</span>
<span class="sd">    """</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'path'</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="n">default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FileSelector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">objects</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">,</span>
                                           <span class="n">empty_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FileSelector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_on_set</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">new</span><span class="p">,</span> <span class="n">old</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">attribute</span> <span class="o">==</span> <span class="s1">'path'</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="k">else</span> <span class="kc">None</span>

<div class="viewcode-block" id="FileSelector.get_range"><a class="viewcode-back" href="../../reference.html#param.__init__.FileSelector.get_range">[docs]</a>    <span class="k">def</span> <span class="nf">get_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">abbreviate_paths</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span><span class="nb">super</span><span class="p">(</span><span class="n">FileSelector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_range</span><span class="p">())</span></div></div>


<div class="viewcode-block" id="ListSelector"><a class="viewcode-back" href="../../reference.html#param.__init__.ListSelector">[docs]</a><span class="k">class</span> <span class="nc">ListSelector</span><span class="p">(</span><span class="n">Selector</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Variant of Selector where the value can be multiple objects from</span>
<span class="sd">    a list of possible objects.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">objects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ListSelector</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">objects</span><span class="o">=</span><span class="n">objects</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">empty_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="ListSelector.compute_default"><a class="viewcode-back" href="../../reference.html#param.__init__.ListSelector.compute_default">[docs]</a>    <span class="k">def</span> <span class="nf">compute_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">compute_default_fn</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_default_fn</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">o</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">ListSelector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="n">o</span><span class="p">)</span></div>



<div class="viewcode-block" id="MultiFileSelector"><a class="viewcode-back" href="../../reference.html#param.__init__.MultiFileSelector">[docs]</a><span class="k">class</span> <span class="nc">MultiFileSelector</span><span class="p">(</span><span class="n">ListSelector</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Given a path glob, allows multiple files to be selected from the list of matches.</span>
<span class="sd">    """</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'path'</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="n">default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MultiFileSelector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">objects</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MultiFileSelector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_on_set</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">new</span><span class="p">,</span> <span class="n">old</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">attribute</span> <span class="o">==</span> <span class="s1">'path'</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">]):</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>

<div class="viewcode-block" id="MultiFileSelector.get_range"><a class="viewcode-back" href="../../reference.html#param.__init__.MultiFileSelector.get_range">[docs]</a>    <span class="k">def</span> <span class="nf">get_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">abbreviate_paths</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span><span class="nb">super</span><span class="p">(</span><span class="n">MultiFileSelector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_range</span><span class="p">())</span></div></div>


<div class="viewcode-block" id="Date"><a class="viewcode-back" href="../../reference.html#param.__init__.Date">[docs]</a><span class="k">class</span> <span class="nc">Date</span><span class="p">(</span><span class="n">Number</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Date parameter of datetime or date type.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Date</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">allow_None</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Checks that the value is numeric and that it is within the hard</span>
<span class="sd">        bounds; if not, an exception is raised.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">dt_types</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Date parameter </span><span class="si">%r</span><span class="s2"> only takes datetime and date types."</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">step</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">dt_types</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Step parameter can only be None, a datetime or datetime type"</span><span class="p">)</span>

<div class="viewcode-block" id="Date.serialize"><a class="viewcode-back" href="../../reference.html#param.__init__.Date.serialize">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">)):</span> <span class="c1"># i.e np.datetime64</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%S.</span><span class="si">%f</span><span class="s2">"</span><span class="p">)</span></div>

<div class="viewcode-block" id="Date.deserialize"><a class="viewcode-back" href="../../reference.html#param.__init__.Date.deserialize">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">"%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%S.</span><span class="si">%f</span><span class="s2">"</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CalendarDate"><a class="viewcode-back" href="../../reference.html#param.__init__.CalendarDate">[docs]</a><span class="k">class</span> <span class="nc">CalendarDate</span><span class="p">(</span><span class="n">Number</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    CalendarDate parameter of date type.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CalendarDate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">allow_None</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Checks that the value is numeric and that it is within the hard</span>
<span class="sd">        bounds; if not, an exception is raised.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"CalendarDate parameter </span><span class="si">%r</span><span class="s2"> only takes datetime types."</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">step</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Step parameter can only be None or a date type."</span><span class="p">)</span>

<div class="viewcode-block" id="CalendarDate.serialize"><a class="viewcode-back" href="../../reference.html#param.__init__.CalendarDate.serialize">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%Y-%m-</span><span class="si">%d</span><span class="s2">"</span><span class="p">)</span></div>

<div class="viewcode-block" id="CalendarDate.deserialize"><a class="viewcode-back" href="../../reference.html#param.__init__.CalendarDate.deserialize">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">"%Y-%m-</span><span class="si">%d</span><span class="s2">"</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="Color"><a class="viewcode-back" href="../../reference.html#param.__init__.Color">[docs]</a><span class="k">class</span> <span class="nc">Color</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Color parameter defined as a hex RGB string with an optional #</span>
<span class="sd">    prefix or (optionally) as a CSS3 color name.</span>
<span class="sd">    """</span>

    <span class="c1"># CSS3 color specification https://www.w3.org/TR/css-color-3/#svg-color</span>
    <span class="n">_named_colors</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">'aliceblue'</span><span class="p">,</span> <span class="s1">'antiquewhite'</span><span class="p">,</span> <span class="s1">'aqua'</span><span class="p">,</span>
        <span class="s1">'aquamarine'</span><span class="p">,</span> <span class="s1">'azure'</span><span class="p">,</span> <span class="s1">'beige'</span><span class="p">,</span> <span class="s1">'bisque'</span><span class="p">,</span> <span class="s1">'black'</span><span class="p">,</span>
        <span class="s1">'blanchedalmond'</span><span class="p">,</span> <span class="s1">'blue'</span><span class="p">,</span> <span class="s1">'blueviolet'</span><span class="p">,</span> <span class="s1">'brown'</span><span class="p">,</span> <span class="s1">'burlywood'</span><span class="p">,</span>
        <span class="s1">'cadetblue'</span><span class="p">,</span> <span class="s1">'chartreuse'</span><span class="p">,</span> <span class="s1">'chocolate'</span><span class="p">,</span> <span class="s1">'coral'</span><span class="p">,</span>
        <span class="s1">'cornflowerblue'</span><span class="p">,</span> <span class="s1">'cornsilk'</span><span class="p">,</span> <span class="s1">'crimson'</span><span class="p">,</span> <span class="s1">'cyan'</span><span class="p">,</span> <span class="s1">'darkblue'</span><span class="p">,</span>
        <span class="s1">'darkcyan'</span><span class="p">,</span> <span class="s1">'darkgoldenrod'</span><span class="p">,</span> <span class="s1">'darkgray'</span><span class="p">,</span> <span class="s1">'darkgrey'</span><span class="p">,</span>
        <span class="s1">'darkgreen'</span><span class="p">,</span> <span class="s1">'darkkhaki'</span><span class="p">,</span> <span class="s1">'darkmagenta'</span><span class="p">,</span> <span class="s1">'darkolivegreen'</span><span class="p">,</span>
        <span class="s1">'darkorange'</span><span class="p">,</span> <span class="s1">'darkorchid'</span><span class="p">,</span> <span class="s1">'darkred'</span><span class="p">,</span> <span class="s1">'darksalmon'</span><span class="p">,</span>
        <span class="s1">'darkseagreen'</span><span class="p">,</span> <span class="s1">'darkslateblue'</span><span class="p">,</span> <span class="s1">'darkslategray'</span><span class="p">,</span>
        <span class="s1">'darkslategrey'</span><span class="p">,</span> <span class="s1">'darkturquoise'</span><span class="p">,</span> <span class="s1">'darkviolet'</span><span class="p">,</span> <span class="s1">'deeppink'</span><span class="p">,</span>
        <span class="s1">'deepskyblue'</span><span class="p">,</span> <span class="s1">'dimgray'</span><span class="p">,</span> <span class="s1">'dimgrey'</span><span class="p">,</span> <span class="s1">'dodgerblue'</span><span class="p">,</span>
        <span class="s1">'firebrick'</span><span class="p">,</span> <span class="s1">'floralwhite'</span><span class="p">,</span> <span class="s1">'forestgreen'</span><span class="p">,</span> <span class="s1">'fuchsia'</span><span class="p">,</span>
        <span class="s1">'gainsboro'</span><span class="p">,</span> <span class="s1">'ghostwhite'</span><span class="p">,</span> <span class="s1">'gold'</span><span class="p">,</span> <span class="s1">'goldenrod'</span><span class="p">,</span> <span class="s1">'gray'</span><span class="p">,</span>
        <span class="s1">'grey'</span><span class="p">,</span> <span class="s1">'green'</span><span class="p">,</span> <span class="s1">'greenyellow'</span><span class="p">,</span> <span class="s1">'honeydew'</span><span class="p">,</span> <span class="s1">'hotpink'</span><span class="p">,</span>
        <span class="s1">'indianred'</span><span class="p">,</span> <span class="s1">'indigo'</span><span class="p">,</span> <span class="s1">'ivory'</span><span class="p">,</span> <span class="s1">'khaki'</span><span class="p">,</span> <span class="s1">'lavender'</span><span class="p">,</span>
        <span class="s1">'lavenderblush'</span><span class="p">,</span> <span class="s1">'lawngreen'</span><span class="p">,</span> <span class="s1">'lemonchiffon'</span><span class="p">,</span> <span class="s1">'lightblue'</span><span class="p">,</span>
        <span class="s1">'lightcoral'</span><span class="p">,</span> <span class="s1">'lightcyan'</span><span class="p">,</span> <span class="s1">'lightgoldenrodyellow'</span><span class="p">,</span>
        <span class="s1">'lightgray'</span><span class="p">,</span> <span class="s1">'lightgrey'</span><span class="p">,</span> <span class="s1">'lightgreen'</span><span class="p">,</span> <span class="s1">'lightpink'</span><span class="p">,</span>
        <span class="s1">'lightsalmon'</span><span class="p">,</span> <span class="s1">'lightseagreen'</span><span class="p">,</span> <span class="s1">'lightskyblue'</span><span class="p">,</span>
        <span class="s1">'lightslategray'</span><span class="p">,</span> <span class="s1">'lightslategrey'</span><span class="p">,</span> <span class="s1">'lightsteelblue'</span><span class="p">,</span>
        <span class="s1">'lightyellow'</span><span class="p">,</span> <span class="s1">'lime'</span><span class="p">,</span> <span class="s1">'limegreen'</span><span class="p">,</span> <span class="s1">'linen'</span><span class="p">,</span> <span class="s1">'magenta'</span><span class="p">,</span>
        <span class="s1">'maroon'</span><span class="p">,</span> <span class="s1">'mediumaquamarine'</span><span class="p">,</span> <span class="s1">'mediumblue'</span><span class="p">,</span> <span class="s1">'mediumorchid'</span><span class="p">,</span>
        <span class="s1">'mediumpurple'</span><span class="p">,</span> <span class="s1">'mediumseagreen'</span><span class="p">,</span> <span class="s1">'mediumslateblue'</span><span class="p">,</span>
        <span class="s1">'mediumspringgreen'</span><span class="p">,</span> <span class="s1">'mediumturquoise'</span><span class="p">,</span> <span class="s1">'mediumvioletred'</span><span class="p">,</span>
        <span class="s1">'midnightblue'</span><span class="p">,</span> <span class="s1">'mintcream'</span><span class="p">,</span> <span class="s1">'mistyrose'</span><span class="p">,</span> <span class="s1">'moccasin'</span><span class="p">,</span>
        <span class="s1">'navajowhite'</span><span class="p">,</span> <span class="s1">'navy'</span><span class="p">,</span> <span class="s1">'oldlace'</span><span class="p">,</span> <span class="s1">'olive'</span><span class="p">,</span> <span class="s1">'olivedrab'</span><span class="p">,</span>
        <span class="s1">'orange'</span><span class="p">,</span> <span class="s1">'orangered'</span><span class="p">,</span> <span class="s1">'orchid'</span><span class="p">,</span> <span class="s1">'palegoldenrod'</span><span class="p">,</span> <span class="s1">'palegreen'</span><span class="p">,</span>
        <span class="s1">'paleturquoise'</span><span class="p">,</span> <span class="s1">'palevioletred'</span><span class="p">,</span> <span class="s1">'papayawhip'</span><span class="p">,</span> <span class="s1">'peachpuff'</span><span class="p">,</span>
        <span class="s1">'peru'</span><span class="p">,</span> <span class="s1">'pink'</span><span class="p">,</span> <span class="s1">'plum'</span><span class="p">,</span> <span class="s1">'powderblue'</span><span class="p">,</span> <span class="s1">'purple'</span><span class="p">,</span> <span class="s1">'red'</span><span class="p">,</span>
        <span class="s1">'rosybrown'</span><span class="p">,</span> <span class="s1">'royalblue'</span><span class="p">,</span> <span class="s1">'saddlebrown'</span><span class="p">,</span> <span class="s1">'salmon'</span><span class="p">,</span>
        <span class="s1">'sandybrown'</span><span class="p">,</span> <span class="s1">'seagreen'</span><span class="p">,</span> <span class="s1">'seashell'</span><span class="p">,</span> <span class="s1">'sienna'</span><span class="p">,</span> <span class="s1">'silver'</span><span class="p">,</span>
        <span class="s1">'skyblue'</span><span class="p">,</span> <span class="s1">'slateblue'</span><span class="p">,</span> <span class="s1">'slategray'</span><span class="p">,</span> <span class="s1">'slategrey'</span><span class="p">,</span> <span class="s1">'snow'</span><span class="p">,</span>
        <span class="s1">'springgreen'</span><span class="p">,</span> <span class="s1">'steelblue'</span><span class="p">,</span> <span class="s1">'tan'</span><span class="p">,</span> <span class="s1">'teal'</span><span class="p">,</span> <span class="s1">'thistle'</span><span class="p">,</span>
        <span class="s1">'tomato'</span><span class="p">,</span> <span class="s1">'turquoise'</span><span class="p">,</span> <span class="s1">'violet'</span><span class="p">,</span> <span class="s1">'wheat'</span><span class="p">,</span> <span class="s1">'white'</span><span class="p">,</span>
        <span class="s1">'whitesmoke'</span><span class="p">,</span> <span class="s1">'yellow'</span><span class="p">,</span> <span class="s1">'yellowgreen'</span><span class="p">]</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'allow_named'</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_named</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Color</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allow_named</span> <span class="o">=</span> <span class="n">allow_named</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_value</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_allow_named</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_named</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">allow_None</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Color parameter </span><span class="si">%r</span><span class="s2"> expects a string value, "</span>
                             <span class="s2">"not an object of type </span><span class="si">%s</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_validate_allow_named</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">allow_named</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="n">is_hex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">'^#?(([0-9a-fA-F]</span><span class="si">{2}</span><span class="s1">)</span><span class="si">{3}</span><span class="s1">|([0-9a-fA-F])</span><span class="si">{3}</span><span class="s1">)$'</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_named</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_hex</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_named_colors</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Color '</span><span class="si">%s</span><span class="s2">' only takes RGB hex codes "</span>
                                 <span class="s2">"or named colors, received '</span><span class="si">%s</span><span class="s2">'."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">is_hex</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Color '</span><span class="si">%s</span><span class="s2">' only accepts valid RGB hex "</span>
                             <span class="s2">"codes, received '</span><span class="si">%s</span><span class="s2">'."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span></div>


<div class="viewcode-block" id="Range"><a class="viewcode-back" href="../../reference.html#param.__init__.Range">[docs]</a><span class="k">class</span> <span class="nc">Range</span><span class="p">(</span><span class="n">NumericTuple</span><span class="p">):</span>
    <span class="s2">"A numeric range with optional bounds and softbounds"</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'bounds'</span><span class="p">,</span> <span class="s1">'inclusive_bounds'</span><span class="p">,</span> <span class="s1">'softbounds'</span><span class="p">,</span> <span class="s1">'step'</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">softbounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">inclusive_bounds</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">),</span> <span class="n">step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inclusive_bounds</span> <span class="o">=</span> <span class="n">inclusive_bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">softbounds</span> <span class="o">=</span> <span class="n">softbounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="n">step</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Range</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Range</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_bounds</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inclusive_bounds</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">inclusive_bounds</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="n">incmin</span><span class="p">,</span> <span class="n">incmax</span> <span class="o">=</span> <span class="n">inclusive_bounds</span>
        <span class="k">for</span> <span class="n">bound</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">'lower'</span><span class="p">,</span> <span class="s1">'upper'</span><span class="p">],</span> <span class="n">val</span><span class="p">):</span>
            <span class="n">too_low</span> <span class="o">=</span> <span class="p">(</span><span class="n">vmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span> <span class="o">&lt;</span> <span class="n">vmin</span> <span class="k">if</span> <span class="n">incmin</span> <span class="k">else</span> <span class="n">v</span> <span class="o">&lt;=</span> <span class="n">vmin</span><span class="p">)</span>
            <span class="n">too_high</span> <span class="o">=</span> <span class="p">(</span><span class="n">vmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span> <span class="o">&gt;</span> <span class="n">vmax</span> <span class="k">if</span> <span class="n">incmax</span> <span class="k">else</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="n">vmax</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">too_low</span> <span class="ow">or</span> <span class="n">too_high</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Range parameter </span><span class="si">%r</span><span class="s2">'s </span><span class="si">%s</span><span class="s2"> bound must be in range </span><span class="si">%s</span><span class="s2">."</span>
                                 <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">bound</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rangestr</span><span class="p">()))</span>


    <span class="k">def</span> <span class="nf">get_soft_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">get_soft_bounds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">softbounds</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">rangestr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span>
        <span class="n">incmin</span><span class="p">,</span> <span class="n">incmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inclusive_bounds</span>
        <span class="n">incmin</span> <span class="o">=</span> <span class="s1">'['</span> <span class="k">if</span> <span class="n">incmin</span> <span class="k">else</span> <span class="s1">'('</span>
        <span class="n">incmax</span> <span class="o">=</span> <span class="s1">']'</span> <span class="k">if</span> <span class="n">incmax</span> <span class="k">else</span> <span class="s1">')'</span>
        <span class="k">return</span> <span class="s1">'</span><span class="si">%s%s</span><span class="s1">, </span><span class="si">%s%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">incmin</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">incmax</span><span class="p">)</span></div>


<div class="viewcode-block" id="DateRange"><a class="viewcode-back" href="../../reference.html#param.__init__.DateRange">[docs]</a><span class="k">class</span> <span class="nc">DateRange</span><span class="p">(</span><span class="n">Range</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    A datetime or date range specified as (start, end).</span>

<span class="sd">    Bounds must be specified as datetime or date types (see param.dt_types).</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="nf">_validate_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">allow_None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dt_types</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"DateRange parameter </span><span class="si">%r</span><span class="s2"> only takes datetime "</span>
                             <span class="s2">"types, not </span><span class="si">%s</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>

        <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">end</span> <span class="o">&gt;=</span> <span class="n">start</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"DateRange parameter </span><span class="si">%r</span><span class="s2">'s end datetime </span><span class="si">%s</span><span class="s2"> "</span>
                             <span class="s2">"is before start datetime </span><span class="si">%s</span><span class="s2">."</span> <span class="o">%</span>
                             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span></div>



<div class="viewcode-block" id="CalendarDateRange"><a class="viewcode-back" href="../../reference.html#param.__init__.CalendarDateRange">[docs]</a><span class="k">class</span> <span class="nc">CalendarDateRange</span><span class="p">(</span><span class="n">Range</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    A date range specified as (start_date, end_date).</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="nf">_validate_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">allow_None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"CalendarDateRange parameter </span><span class="si">%r</span><span class="s2"> only "</span>
                                 <span class="s2">"takes date types, not </span><span class="si">%s</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>

        <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">end</span> <span class="o">&gt;=</span> <span class="n">start</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"CalendarDateRange parameter </span><span class="si">%r</span><span class="s2">'s end date "</span>
                             <span class="s2">"</span><span class="si">%s</span><span class="s2"> is before start date </span><span class="si">%s</span><span class="s2">."</span> <span class="o">%</span>
                             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span></div>


<div class="viewcode-block" id="Event"><a class="viewcode-back" href="../../reference.html#param.__init__.Event">[docs]</a><span class="k">class</span> <span class="nc">Event</span><span class="p">(</span><span class="n">Boolean</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    An Event Parameter is one whose value is intimately linked to the</span>
<span class="sd">    triggering of events for watchers to consume. Event has a Boolean</span>
<span class="sd">    value, which when set to True triggers the associated watchers (as</span>
<span class="sd">    any Parameter does) and then is automatically set back to</span>
<span class="sd">    False. Conversely, if events are triggered directly via `.trigger`,</span>
<span class="sd">    the value is transiently set to True (so that it's clear which of</span>
<span class="sd">    many parameters being watched may have changed), then restored to</span>
<span class="sd">    False when the triggering completes. An Event parameter is thus like</span>
<span class="sd">    a momentary switch or pushbutton with a transient True value that</span>
<span class="sd">    serves only to launch some other action (e.g. via a param.depends</span>
<span class="sd">    decorator), rather than encapsulating the action itself as</span>
<span class="sd">    param.Action does.</span>
<span class="sd">    """</span>

    <span class="c1"># _autotrigger_value specifies the value used to set the parameter</span>
    <span class="c1"># to when the parameter is supplied to the trigger method. This</span>
    <span class="c1"># value change is then what triggers the watcher callbacks.</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'_autotrigger_value'</span><span class="p">,</span> <span class="s1">'_mode'</span><span class="p">,</span> <span class="s1">'_autotrigger_reset_value'</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_autotrigger_value</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_autotrigger_reset_value</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s1">'set-reset'</span>
        <span class="c1"># Mode can be one of 'set', 'set-reset' or 'reset'</span>

        <span class="c1"># 'set' is normal Boolean parameter behavior when set with a value.</span>
        <span class="c1"># 'set-reset' temporarily sets the parameter (which triggers</span>
        <span class="c1"># watching callbacks) but immediately resets the value back to</span>
        <span class="c1"># False.</span>
        <span class="c1"># 'reset' applies the reset from True to False without</span>
        <span class="c1"># triggering watched callbacks</span>

        <span class="c1"># This _mode attribute is one of the few places where a specific</span>
        <span class="c1"># parameter has a special behavior that is relied upon by the</span>
        <span class="c1"># core functionality implemented in</span>
        <span class="c1"># parameterized.py. Specifically, the set_param method</span>
        <span class="c1"># temporarily sets this attribute in order to disable resetting</span>
        <span class="c1"># back to False while triggered callbacks are executing</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Event</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_reset_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_internal_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_setter</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

    <span class="nd">@instance_descriptor</span>
    <span class="k">def</span> <span class="fm">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'set-reset'</span><span class="p">,</span> <span class="s1">'set'</span><span class="p">]:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">Event</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__set__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'set-reset'</span><span class="p">,</span> <span class="s1">'reset'</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_reset_event</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span></div>


<span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">contextmanager</span>
<div class="viewcode-block" id="exceptions_summarized"><a class="viewcode-back" href="../../reference.html#param.__init__.exceptions_summarized">[docs]</a><span class="nd">@contextmanager</span>
<span class="k">def</span> <span class="nf">exceptions_summarized</span><span class="p">():</span>
    <span class="sd">"""Useful utility for writing docs that need to show expected errors.</span>
<span class="sd">    Shows exception only, concisely, without a traceback.</span>
<span class="sd">    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">yield</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">sys</span>
        <span class="n">etype</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tb</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">etype</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="n">value</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span></div>
</pre></div>
</div>
<div class="prev-next-bottom">
</div>
</main>
</div>
</div>
<script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-154795830-6', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>
<footer class="footer mt-5 mt-md-0">
<div class="container">
<div class="footer-item">
<p class="copyright">
    Â© Copyright 2003-2021 HoloViz developers.<br/>
</p>
</div>
<div class="footer-item">
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br/>
</p>
</div>
</div>
</footer>
</body>
</html>